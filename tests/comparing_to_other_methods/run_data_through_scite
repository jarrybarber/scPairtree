SIMDIR=~/work/sc_pairtree/tests/comparing_to_other_methods/sim_data
BINDIR=~/work/phylo_methods/SCITE
RESDIR=~/work/sc_pairtree/tests/comparing_to_other_methods/results/scite


function run_all_sims {

  #n_muts = [10, 20, 50, 100]
  #n_cells = [100, 500, 1000]
  FPR=0.001
  ADO=0.3
  cell_alpha=1
  mut_alpha=1
  d_rng_id=1
  n_rep=4
  thin_frac=0.2

  for M in 10 20 50 100; do
  for C in 100 500 1000 ; do
  for FPR in 0.001; do
  for ADO in 0.3; do
  for run in 1; do
    echo $M $C
    fn=m${M}_c${C}_fp${FPR}_ad${ADO}_ca${cell_alpha}_ma${mut_alpha}_dr_${d_rng_id}
    data_fn=$SIMDIR/$fn.data
    out_fn=$RESDIR/$fn
    #bsub -n4 -R rusage[mem=4] -W 2:00 python $BINDIR/sc_pairtree.py $data_fn --seed 1000 --data-range 1 --parallel 4 --trees-per-chain $C*$C*50 --burnin 0.5 --thinned-frac 0.5
    n_samp=`expr 100 \* $M`
    tpc=`expr $M \* 20000`
    #python $BINDIR/sc_pairtree.py $data_fn $out_fn --seed 1000 --data-range 1 --parallel $n_rep --trees-per-chain $tpc --burnin 0.5 --thinned-frac 0.5
    ${BINDIR}/scite -i $data_fn -o $out_fn -n $M -m $C -r $n_rep -l $tpc -fd 5e-5 -ad 0.2 -p $n_samp -s -g 1 -seed 1000 -no_tree_list > $out_fn.log
  done
  done
  done
  done
  done
}

function main {
  run_all_sims
}

main